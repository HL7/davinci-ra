<?xml version="1.0" encoding="UTF-8"?>
<StructureDefinition
    xmlns="http://hl7.org/fhir">
    <id value="ra-detectedissue"/>
    <url value="http://hl7.org/fhir/us/davinci-ra/StructureDefinition/ra-detectedissue"/>
    <name value="RADetectedIssueProfile"/>
    <title value="Risk Adjustment Detected Issue Profile"/>
    <status value="draft"/>
    <date value="2022-03-22"/>
    <publisher value="Da Vinci Project"/>
    <description value="RA DetectedIssue profile mockup"/>
    <fhirVersion value="4.0.1"/>
    <kind value="resource"/>
    <abstract value="false"/>
    <type value="DetectedIssue"/>
    <baseDefinition value="http://hl7.org/fhir/StructureDefinition/DetectedIssue"/>
    <derivation value="constraint"/>
    <differential>
        <element id="DetectedIssue">
            <path value="DetectedIssue"/>
        </element>
        <element id="DetectedIssue.modifierExtension:codingGapStatus">
           <path value="DetectedIssue.modifierExtension"/>
           <sliceName value="codingGapStatus"/>
           <min value="1"/>
           <max value="1"/>
           <type>
             <code value="Extension"/>
             <profile value="http://hl7.org/fhir/us/davinci-ra/StructureDefinition/extension-codingGapStatus"/>
           </type>
           <mustSupport value="true"/>
           <isModifier value="true"/>
           <isModifierReason value="What is the detected coding gap status"/>
        </element>
        <element id="DetectedIssue.extension:groupReference">
          <path value="DetectedIssue.extension"/>
          <sliceName value="groupReference"/>
          <definition value="This id references the `MeasureReport.group.id`, which allows linking a detected issue to a specific Condition Category (CC) coding gap."/>
          <min value="0"/>
          <max value="*"/>
          <type>
            <code value="Extension"/>
            <profile value="http://hl7.org/fhir/us/davinci-ra/StructureDefinition/ra-groupReference"/>
          </type>
          <mustSupport value="true"/>
        </element>
        <element id="DetectedIssue.code">
          <path value="DetectedIssue.code"/>
          <min value="1"/>
          <fixedCodeableConcept>
              <coding>
                  <system value="http://terminology.hl7.org/CodeSystem/v3-ActCode"/>
                  <code value="CODINGGAP"/>
                  <display value="Coding Gaps"/>
              </coding>
          </fixedCodeableConcept>
          <mustSupport value="true"/>
        </element>
        <element id="DetectedIssue.patient">
            <path value="DetectedIssue.patient"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient"/>
            </type>
            <min value="1"/>
            <mustSupport value="true"/>
        </element>
        <element id="DetectedIssue.evidence">
            <path value="DetectedIssue.evidence"/>
            <min value="1"/>
            <mustSupport value="true"/>
        </element>
<!--
        <element id="DetectedIssue.evidence.detail">
            <path value="DetectedIssue.evidence.detail"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/us/davinci-ra/StructureDefinition/ra-measurereport"/>
            </type>
            <min value="1"/>
            <max value="1"/>
            <mustSupport value="true"/>
        </element> -->
        <element id="DetectedIssue.detail">
            <path value="DetectedIssue.detail"/>
            <min value="1"/>
            <max value="1"/>
            <mustSupport value="true"/>
        </element>
    </differential>
</StructureDefinition>
